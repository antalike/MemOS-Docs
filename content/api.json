{
  "openapi": "3.1.0",
  "info": {
    "title": "MemOS REST APIs",
    "description": "A REST API for managing and searching memories using MemOS.",
    "version": "1.0.0"
  },
  "paths": {
    "/product/search": {
      "post": {
        "summary": "Search memories",
        "description": "Search memories for a specific user.",
        "operationId": "search_memories_product_search_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/APISearchRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SearchResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/product/add": {
      "post": {
        "summary": "Add memories",
        "description": "Add memories for a specific user.",
        "operationId": "add_memories_product_add_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/APIADDRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MemoryResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/product/get_all": {
      "post": {
        "summary": "Get all memories for user",
        "description": "Get all memories or subgraph for a specific user. If search_query is provided, returns a subgraph based on the query. Otherwise, returns all memories of the specified type.",
        "operationId": "get_all_memories_product_get_all_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/GetMemoryPlaygroundRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MemoryResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/product/get_memory": {
      "post": {
        "summary": "Get memories for user",
        "description": "Get memories for user with pagination support.",
        "operationId": "get_memories_product_get_memory_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/GetMemoryRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/GetMemoryResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/product/get_memory/{memory_id}": {
      "get": {
        "summary": "Get memory by id",
        "description": "Get a specific memory by its ID.",
        "operationId": "get_memory_by_id_product_get_memory__memory_id__get",
        "parameters": [
          {
            "name": "memory_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Memory Id"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/GetMemoryResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/product/delete_memory": {
      "post": {
        "summary": "Delete memories for user",
        "description": "Delete memories for a specific user.",
        "operationId": "delete_memories_product_delete_memory_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/DeleteMemoryRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DeleteMemoryResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/product/chat/complete": {
      "post": {
        "summary": "Chat with MemOS (Complete Response)",
        "description": "Chat with MemOS for a specific user. Returns complete response (non-streaming).",
        "operationId": "chat_complete_product_chat_complete_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/APIChatCompleteRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "title": "ChatResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/product/chat/stream": {
      "post": {
        "summary": "Chat with MemOS",
        "description": "Chat with MemOS for a specific user. Returns SSE stream.",
        "operationId": "chat_stream_product_chat_stream_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ChatRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "text/event-stream": {
                "schema": {
                  "type": "string"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/product/chat/stream/playground": {
      "post": {
        "summary": "Chat with MemOS playground",
        "description": "Chat with MemOS for a specific user in playground. Returns SSE stream.",
        "operationId": "chat_stream_playground_product_chat_stream_playground_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ChatPlaygroundRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "text/event-stream": {
                "schema": {
                  "type": "string"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/product/suggestions": {
      "post": {
        "summary": "Get suggestion queries",
        "description": "Get suggestion queries for a specific user with language preference.",
        "operationId": "get_suggestion_queries_product_suggestions_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/SuggestionRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SuggestionResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/product/feedback": {
      "post": {
        "summary": "Feedback memories",
        "description": "Feedback memories for a specific user.",
        "operationId": "feedback_memories_product_feedback_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/APIFeedbackRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MemoryResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/product/scheduler/allstatus": {
      "get": {
        "summary": "Get detailed scheduler status",
        "description": "Get detailed scheduler status including running tasks and queue metrics.",
        "operationId": "scheduler_allstatus_product_scheduler_allstatus_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AllStatusResponse"
                }
              }
            }
          }
        }
      }
    },
    "/product/scheduler/status": {
      "get": {
        "summary": "Get scheduler running status",
        "description": "Get scheduler running status.",
        "operationId": "scheduler_status_product_scheduler_status_get",
        "parameters": [
          {
            "name": "user_id",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string",
              "title": "User Id"
            },
            "description": "User ID"
          },
          {
            "name": "task_id",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Task Id"
            },
            "description": "Optional Task ID to query a specific task"
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/StatusResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/product/scheduler/task_queue_status": {
      "get": {
        "summary": "Get scheduler task queue status",
        "description": "Get scheduler task queue backlog/pending status for a user.",
        "operationId": "scheduler_task_queue_status_product_scheduler_task_queue_status_get",
        "parameters": [
          {
            "name": "user_id",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string",
              "title": "User Id"
            },
            "description": "User ID whose queue status is requested"
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TaskQueueResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/product/scheduler/wait": {
      "post": {
        "summary": "Wait until scheduler is idle for a specific user",
        "description": "Wait until scheduler is idle for a specific user.",
        "operationId": "scheduler_wait_product_scheduler_wait_post",
        "parameters": [
          {
            "name": "user_name",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string",
              "title": "User Name"
            }
          },
          {
            "name": "timeout_seconds",
            "in": "query",
            "required": false,
            "schema": {
              "type": "number",
              "title": "Timeout Seconds",
              "default": 120.0
            }
          },
          {
            "name": "poll_interval",
            "in": "query",
            "required": false,
            "schema": {
              "type": "number",
              "title": "Poll Interval",
              "default": 0.5
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "title": "Response"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/product/scheduler/wait/stream": {
      "get": {
        "summary": "Stream scheduler progress for a user",
        "description": "Stream scheduler progress via Server-Sent Events (SSE).",
        "operationId": "scheduler_wait_stream_product_scheduler_wait_stream_get",
        "parameters": [
          {
            "name": "user_name",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string",
              "title": "User Name"
            }
          },
          {
            "name": "timeout_seconds",
            "in": "query",
            "required": false,
            "schema": {
              "type": "number",
              "title": "Timeout Seconds",
              "default": 120.0
            }
          },
          {
            "name": "poll_interval",
            "in": "query",
            "required": false,
            "schema": {
              "type": "number",
              "title": "Poll Interval",
              "default": 0.5
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "text/event-stream": {
                "schema": {
                  "type": "string"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/product/get_user_names_by_memory_ids": {
      "post": {
        "summary": "Get user names by memory ids",
        "description": "Get user names by memory ids.",
        "operationId": "get_user_names_by_memory_ids_product_get_user_names_by_memory_ids_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/GetUserNamesByMemoryIdsRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/GetUserNamesByMemoryIdsResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/product/exist_mem_cube_id": {
      "post": {
        "summary": "Check if mem cube id exists",
        "description": "Check if mem cube id exists.",
        "operationId": "exist_mem_cube_id_product_exist_mem_cube_id_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ExistMemCubeIdRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ExistMemCubeIdResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    }
  },
  "components": {
    "schemas": {
      "APISearchRequest": {
        "properties": {
          "query": { "type": "string", "title": "Query", "description": "User search query" },
          "user_id": { "type": "string", "title": "User Id", "description": "User ID" },
          "readable_cube_ids": { "type": "array", "items": { "type": "string" }, "title": "Readable Cube Ids", "description": "List of cube IDs that are readable for this request. Required for algorithm-facing API; optional for developer-facing API." },
          "mode": { "$ref": "#/components/schemas/SearchMode"},
          "session_id": { "type": "string", "title": "Session Id", "description": "Session ID used as a soft signal to prioritize more relevant memories. Only used for weighting, not as a hard filter." },
          "top_k": { "type": "integer", "title": "Top K", "description": "Number of textual memories to retrieve (top-K). Default: 10.", "default": 10 },
          "dedup": { "type": "string", "enum": ["no", "sim"], "title": "Dedup", "description": "Optional dedup option for textual memories. Use 'no' for no dedup, 'sim' for similarity dedup. If None, default exact-text dedup is applied." },
          "pref_top_k": { "type": "integer", "title": "Pref Top K", "description": "Number of preference memories to retrieve (top-K). Default: 6.", "default": 6 },
          "include_preference": { "type": "boolean", "title": "Include Preference", "description": "Whether to retrieve preference memories along with general memories. If enabled, the system will automatically recall user preferences relevant to the query. Default: True.", "default": true },
          "search_tool_memory": { "type": "boolean", "title": "Search Tool Memory", "description": "Whether to retrieve tool memories along with general memories. If enabled, the system will automatically recall tool memories relevant to the query. Default: True.", "default": true },
          "tool_mem_top_k": { "type": "integer", "title": "Tool Mem Top K", "description": "Number of tool memories to retrieve (top-K). Default: 6.", "default": 6 },
          "filter": { "type": "object", "title": "Filter", "description": "Filter for the memory" },
          "internet_search": { "type": "boolean", "title": "Internet Search", "description": "Whether to enable internet search in addition to memory search. Primarily used by internal algorithms. Default: False.", "default": false },
          "threshold": { "type": "number", "title": "Threshold", "description": "Internal similarity threshold for searching plaintext memories. If None, default thresholds will be applied." },
          "search_memory_type": { "type": "string", "title": "Search Memory Type", "description": "Type of memory to search: All, WorkingMemory, LongTermMemory, UserMemory, OuterMemory, ToolSchemaMemory, ToolTrajectoryMemory", "default": "All" },
          "chat_history": { "type": "array", "items": { "type": "object" }, "title": "Chat History", "description": "Historical chat messages used internally by algorithms. If None, internal stored history may be used; if provided (even an empty list), this value will be used as-is." },
          "mem_cube_id": { "type": "string", "title": "Mem Cube Id", "description": "(Deprecated) Single cube ID to search in. Prefer `readable_cube_ids` for multi-cube search." },
          "moscube": { "type": "boolean", "title": "Moscube", "description": "(Deprecated / internal) Whether to use legacy MemOSCube path.", "default": false },
          "operation": { "type": "array", "items": { "type": "object" }, "title": "Operation", "description": "(Internal) Operation definitions for multi-cube read permissions." },
          "source": { "type": "string", "title": "Source", "description": "Source of the search query [plugin will router diff search]" }
        },
        "required": ["query", "user_id"],
        "type": "object",
        "title": "APISearchRequest"
      },
      "SearchMode": {
        "type": "string",
        "enum": ["fast", "fine", "mixture"],
        "title": "SearchMode",
        "description": "Enumeration for search modes."
      },
      "SearchResponse": {
        "properties": {
          "code": { "type": "integer", "title": "Code", "description": "Response status code", "default": 200 },
          "message": { "type": "string", "title": "Message", "description": "Response message" },
          "data": { "type": "object", "title": "Data", "description": "Response data" }
        },
        "required": ["message"],
        "type": "object",
        "title": "SearchResponse"
      },
      "APIADDRequest": {
        "properties": {
          "user_id": { "type": "string", "title": "User Id", "description": "User ID" },
          "session_id": { "type": "string", "title": "Session Id", "description": "Session ID. If not provided, a default session will be used." },
          "task_id": { "type": "string", "title": "Task Id", "description": "Task ID for monitering async tasks" },
          "writable_cube_ids": { "type": "array", "items": { "type": "string" }, "title": "Writable Cube Ids", "description": "List of cube IDs user can write for multi-cube add" },
          "async_mode": { "type": "string", "enum": ["async", "sync"], "title": "Async Mode", "description": "Whether to add memory in async mode. Use 'async' to enqueue background add (non-blocking), or 'sync' to add memories in the current call. Default: 'async'.", "default": "async" },
          "mode": { "type": "string", "enum": ["fast", "fine"], "title": "Mode", "description": "(Internal) Add mode used only when async_mode='sync'. If set to 'fast', the handler will use a fast add pipeline. Ignored when async_mode='async'." },
          "custom_tags": { "type": "array", "items": { "type": "string" }, "title": "Custom Tags", "description": "Custom tags for this add request, e.g. ['Travel', 'family']. These tags can be used as filters in search." },
          "info": { "type": "object", "title": "Info", "description": "Additional metadata for the add request. All keys can be used as filters in search." },
          "messages": {
             "anyOf": [
               { "type": "string" },
               { "type": "array", "items": { "type": "object" } }
             ],
             "title": "Messages",
             "description": "List of messages to store."
          },
          "chat_history": { "type": "array", "items": { "type": "object" }, "title": "Chat History", "description": "Historical chat messages used internally by algorithms. If None, internal stored history will be used; if provided (even an empty list), this value will be used as-is." },
          "is_feedback": { "type": "boolean", "title": "Is Feedback", "description": "Whether this request represents user feedback. Default: False.", "default": false },
          "mem_cube_id": { "type": "string", "title": "Mem Cube Id", "description": "(Deprecated) Target cube ID for this add request (optional for developer API)." },
          "memory_content": { "type": "string", "title": "Memory Content", "description": "(Deprecated) Plain memory content to store. Prefer using `messages`." },
          "doc_path": { "type": "string", "title": "Doc Path", "description": "(Deprecated / internal) Path to document to store." },
          "source": { "type": "string", "title": "Source", "description": "(Deprecated) Simple source tag of the memory. Prefer using `info.source_type` / `info.source_url`." },
          "operation": { "type": "array", "items": { "type": "object" }, "title": "Operation", "description": "(Internal) Operation definitions for multi-cube write permissions." }
        },
        "type": "object",
        "title": "APIADDRequest"
      },
      "MemoryResponse": {
        "properties": {
          "code": { "type": "integer", "title": "Code", "description": "Response status code", "default": 200 },
          "message": { "type": "string", "title": "Message", "description": "Response message" },
          "data": { "type": "array", "items": {}, "title": "Data", "description": "Response data" }
        },
        "required": ["message"],
        "type": "object",
        "title": "MemoryResponse"
      },
      "GetMemoryPlaygroundRequest": {
        "properties": {
          "user_id": { "type": "string", "title": "User Id", "description": "User ID" },
          "memory_type": { "type": "string", "enum": ["text_mem", "act_mem", "param_mem", "para_mem"], "title": "Memory Type", "description": "Memory type" },
          "mem_cube_ids": { "type": "array", "items": { "type": "string" }, "title": "Mem Cube Ids", "description": "Cube IDs" },
          "search_query": { "type": "string", "title": "Search Query", "description": "Search query" }
        },
        "required": ["user_id", "memory_type"],
        "type": "object",
        "title": "GetMemoryPlaygroundRequest"
      },
      "GetMemoryRequest": {
        "properties": {
          "mem_cube_id": { "type": "string", "title": "Mem Cube Id", "description": "Cube ID" },
          "user_id": { "type": "string", "title": "User Id", "description": "User ID" },
          "include_preference": { "type": "boolean", "title": "Include Preference", "description": "Whether to handle preference memory", "default": true },
          "page": { "type": "integer", "title": "Page", "description": "Page number (starts from 1). If None, exports all data without pagination." },
          "page_size": { "type": "integer", "title": "Page Size", "description": "Number of items per page. If None, exports all data without pagination." }
        },
        "required": ["mem_cube_id"],
        "type": "object",
        "title": "GetMemoryRequest"
      },
      "GetMemoryResponse": {
        "properties": {
          "code": { "type": "integer", "title": "Code", "description": "Response status code", "default": 200 },
          "message": { "type": "string", "title": "Message", "description": "Response message" },
          "data": { "type": "object", "title": "Data", "description": "Response data" }
        },
        "required": ["message"],
        "type": "object",
        "title": "GetMemoryResponse"
      },
      "DeleteMemoryRequest": {
        "properties": {
          "writable_cube_ids": { "type": "array", "items": { "type": "string" }, "title": "Writable Cube Ids", "description": "Writable cube IDs" },
          "memory_ids": { "type": "array", "items": { "type": "string" }, "title": "Memory Ids", "description": "Memory IDs" },
          "file_ids": { "type": "array", "items": { "type": "string" }, "title": "File Ids", "description": "File IDs" },
          "filter": { "type": "object", "title": "Filter", "description": "Filter for the memory" }
        },
        "type": "object",
        "title": "DeleteMemoryRequest"
      },
      "DeleteMemoryResponse": {
        "properties": {
          "code": { "type": "integer", "title": "Code", "description": "Response status code", "default": 200 },
          "message": { "type": "string", "title": "Message", "description": "Response message" },
          "data": { "type": "object", "title": "Data", "description": "Response data" }
        },
        "required": ["message"],
        "type": "object",
        "title": "DeleteMemoryResponse"
      },
      "APIChatCompleteRequest": {
        "properties": {
          "user_id": { "type": "string", "title": "User Id", "description": "User ID" },
          "query": { "type": "string", "title": "Query", "description": "Chat query message" },
          "readable_cube_ids": { "type": "array", "items": { "type": "string" }, "title": "Readable Cube Ids", "description": "List of cube IDs user can read for multi-cube chat" },
          "writable_cube_ids": { "type": "array", "items": { "type": "string" }, "title": "Writable Cube Ids", "description": "List of cube IDs user can write for multi-cube chat" },
          "history": { "type": "array", "items": { "type": "object" }, "title": "History", "description": "Chat history" },
          "mode": { "$ref": "#/components/schemas/SearchMode"},
          "system_prompt": { "type": "string", "title": "System Prompt", "description": "Base system prompt to use for chat" },
          "top_k": { "type": "integer", "title": "Top K", "description": "Number of results to return", "default": 10 },
          "session_id": { "type": "string", "title": "Session Id", "description": "Session ID for soft-filtering memories" },
          "include_preference": { "type": "boolean", "title": "Include Preference", "description": "Whether to handle preference memory", "default": true },
          "pref_top_k": { "type": "integer", "title": "Pref Top K", "description": "Number of preference results to return", "default": 6 },
          "model_name_or_path": { "type": "string", "title": "Model Name Or Path", "description": "Model name to use for chat" },
          "max_tokens": { "type": "integer", "title": "Max Tokens", "description": "Max tokens to generate" },
          "temperature": { "type": "number", "title": "Temperature", "description": "Temperature for sampling" },
          "top_p": { "type": "number", "title": "Top P", "description": "Top-p (nucleus) sampling parameter" },
          "add_message_on_answer": { "type": "boolean", "title": "Add Message On Answer", "description": "Add dialogs to memory after chat", "default": true },
          "filter": { "type": "object", "title": "Filter", "description": "Filter for the memory" },
          "internet_search": { "type": "boolean", "title": "Internet Search", "description": "Whether to use internet search", "default": false },
          "threshold": { "type": "number", "title": "Threshold", "description": "Threshold for filtering references", "default": 0.5 },
          "mem_cube_id": { "type": "string", "title": "Mem Cube Id", "description": "Cube ID to use for chat" },
          "moscube": { "type": "boolean", "title": "Moscube", "description": "(Deprecated) Whether to use legacy MemOSCube pipeline", "default": false }
        },
        "required": ["user_id", "query"],
        "type": "object",
        "title": "APIChatCompleteRequest"
      },
      "ChatRequest": {
        "properties": {
          "user_id": { "type": "string", "title": "User Id", "description": "User ID" },
          "query": { "type": "string", "title": "Query", "description": "Chat query message" },
          "readable_cube_ids": { "type": "array", "items": { "type": "string" }, "title": "Readable Cube Ids", "description": "List of cube IDs user can read for multi-cube chat" },
          "writable_cube_ids": { "type": "array", "items": { "type": "string" }, "title": "Writable Cube Ids", "description": "List of cube IDs user can write for multi-cube chat" },
          "history": { "type": "array", "items": { "type": "object" }, "title": "History", "description": "Chat history" },
          "mode": { "$ref": "#/components/schemas/SearchMode"},
          "system_prompt": { "type": "string", "title": "System Prompt", "description": "Base system prompt to use for chat" },
          "top_k": { "type": "integer", "title": "Top K", "description": "Number of results to return", "default": 10 },
          "session_id": { "type": "string", "title": "Session Id", "description": "Session ID for soft-filtering memories" },
          "include_preference": { "type": "boolean", "title": "Include Preference", "description": "Whether to handle preference memory", "default": true },
          "pref_top_k": { "type": "integer", "title": "Pref Top K", "description": "Number of preference results to return", "default": 6 },
          "model_name_or_path": { "type": "string", "title": "Model Name Or Path", "description": "Model name to use for chat" },
          "max_tokens": { "type": "integer", "title": "Max Tokens", "description": "Max tokens to generate" },
          "temperature": { "type": "number", "title": "Temperature", "description": "Temperature for sampling" },
          "top_p": { "type": "number", "title": "Top P", "description": "Top-p (nucleus) sampling parameter" },
          "add_message_on_answer": { "type": "boolean", "title": "Add Message On Answer", "description": "Add dialogs to memory after chat", "default": true },
          "filter": { "type": "object", "title": "Filter", "description": "Filter for the memory" },
          "internet_search": { "type": "boolean", "title": "Internet Search", "description": "Whether to use internet search", "default": false },
          "threshold": { "type": "number", "title": "Threshold", "description": "Threshold for filtering references", "default": 0.5 },
          "moscube": { "type": "boolean", "title": "Moscube", "description": "(Deprecated) Whether to use legacy MemOSCube pipeline.", "default": false },
          "mem_cube_id": { "type": "string", "title": "Mem Cube Id", "description": "(Deprecated) Single cube ID to use for chat. Prefer `readable_cube_ids` / `writable_cube_ids` for multi-cube chat." }
        },
        "required": ["user_id", "query"],
        "type": "object",
        "title": "ChatRequest"
      },
      "ChatPlaygroundRequest": {
        "allOf": [
          { "$ref": "#/components/schemas/ChatRequest" },
          {
            "properties": {
              "beginner_guide_step": { "type": "string", "title": "Beginner Guide Step", "description": "Whether to use beginner guide, option: [first, second]" }
            },
            "type": "object"
          }
        ],
        "title": "ChatPlaygroundRequest"
      },
      "SuggestionRequest": {
        "properties": {
          "user_id": { "type": "string", "title": "User Id", "description": "User ID" },
          "mem_cube_id": { "type": "string", "title": "Mem Cube Id", "description": "Cube ID" },
          "language": { "type": "string", "enum": ["zh", "en"], "title": "Language", "description": "Language for suggestions", "default": "zh" },
          "message": { 
             "anyOf": [
               { "type": "string" },
               { "type": "array", "items": { "type": "object" } }
             ],
             "title": "Message", 
             "description": "List of messages to store." 
          }
        },
        "required": ["user_id", "mem_cube_id"],
        "type": "object",
        "title": "SuggestionRequest"
      },
      "SuggestionResponse": {
        "properties": {
          "code": { "type": "integer", "title": "Code", "description": "Response status code", "default": 200 },
          "message": { "type": "string", "title": "Message", "description": "Response message" },
          "data": { "type": "object", "additionalProperties": { "type": "array", "items": { "type": "string" } }, "title": "Data", "description": "Response data" }
        },
        "required": ["message"],
        "type": "object",
        "title": "SuggestionResponse"
      },
      "APIFeedbackRequest": {
        "properties": {
          "user_id": { "type": "string", "title": "User Id", "description": "User ID" },
          "session_id": { "type": "string", "title": "Session Id", "description": "Session ID for soft-filtering memories", "default": "default_session" },
          "task_id": { "type": "string", "title": "Task Id", "description": "Task ID for monitering async tasks" },
          "history": { "type": "array", "items": { "type": "object" }, "title": "History", "description": "Chat history" },
          "retrieved_memory_ids": { "type": "array", "items": { "type": "string" }, "title": "Retrieved Memory Ids", "description": "Retrieved memory ids at last turn" },
          "feedback_content": { "type": "string", "title": "Feedback Content", "description": "Feedback content to process" },
          "feedback_time": { "type": "string", "title": "Feedback Time", "description": "Feedback time" },
          "writable_cube_ids": { "type": "array", "items": { "type": "string" }, "title": "Writable Cube Ids", "description": "List of cube IDs user can write for multi-cube add" },
          "async_mode": { "type": "string", "enum": ["sync", "async"], "title": "Async Mode", "description": "feedback mode: sync or async", "default": "async" },
          "corrected_answer": { "type": "boolean", "title": "Corrected Answer", "description": "Whether need return corrected answer", "default": false },
          "info": { "type": "object", "title": "Info", "description": "Additional metadata for the add request. All keys can be used as filters in search." },
          "mem_cube_id": { "type": "string", "title": "Mem Cube Id", "description": "(Deprecated) Single cube ID to search in. Prefer `readable_cube_ids` for multi-cube search." }
        },
        "required": ["user_id", "history", "feedback_content"],
        "type": "object",
        "title": "APIFeedbackRequest"
      },
      "AllStatusResponse": {
        "properties": {
          "code": { "type": "integer", "title": "Code", "description": "Response status code", "default": 200 },
          "message": { "type": "string", "title": "Message", "description": "Response message", "default": "Scheduler status summary retrieved successfully" },
          "data": { "$ref": "#/components/schemas/AllStatusResponseData" }
        },
        "required": ["message"],
        "type": "object",
        "title": "AllStatusResponse"
      },
      "AllStatusResponseData": {
        "properties": {
          "scheduler_summary": { "$ref": "#/components/schemas/TaskSummary" },
          "all_tasks_summary": { "$ref": "#/components/schemas/TaskSummary" }
        },
        "required": ["scheduler_summary", "all_tasks_summary"],
        "type": "object",
        "title": "AllStatusResponseData"
      },
      "TaskSummary": {
        "properties": {
          "waiting": { "type": "integer", "title": "Waiting", "description": "Number of tasks waiting to run", "default": 0 },
          "in_progress": { "type": "integer", "title": "In Progress", "description": "Number of tasks currently running", "default": 0 },
          "pending": { "type": "integer", "title": "Pending", "description": "Number of tasks fetched by workers but not yet acknowledged", "default": 0 },
          "completed": { "type": "integer", "title": "Completed", "description": "Number of tasks completed", "default": 0 },
          "failed": { "type": "integer", "title": "Failed", "description": "Number of tasks failed", "default": 0 },
          "cancelled": { "type": "integer", "title": "Cancelled", "description": "Number of tasks cancelled", "default": 0 },
          "total": { "type": "integer", "title": "Total", "description": "Total number of tasks counted", "default": 0 }
        },
        "type": "object",
        "title": "TaskSummary"
      },
      "StatusResponse": {
        "properties": {
          "code": { "type": "integer", "title": "Code", "description": "Response status code", "default": 200 },
          "message": { "type": "string", "title": "Message", "description": "Response message", "default": "Memory get status successfully" },
          "data": { "type": "array", "items": { "$ref": "#/components/schemas/StatusResponseItem" }, "title": "Data", "description": "Response data" }
        },
        "required": ["message"],
        "type": "object",
        "title": "StatusResponse"
      },
      "StatusResponseItem": {
        "properties": {
          "task_id": { "type": "string", "title": "Task Id", "description": "The ID of the task" },
          "status": { "type": "string", "enum": ["in_progress", "completed", "waiting", "failed", "cancelled"], "title": "Status", "description": "The current status of the task" }
        },
        "required": ["task_id", "status"],
        "type": "object",
        "title": "StatusResponseItem"
      },
      "TaskQueueResponse": {
        "properties": {
          "code": { "type": "integer", "title": "Code", "description": "Response status code", "default": 200 },
          "message": { "type": "string", "title": "Message", "description": "Response message", "default": "Scheduler task queue status retrieved successfully" },
          "data": { "$ref": "#/components/schemas/TaskQueueData" }
        },
        "required": ["message"],
        "type": "object",
        "title": "TaskQueueResponse"
      },
      "TaskQueueData": {
        "properties": {
          "user_id": { "type": "string", "title": "User Id", "description": "User ID the query is scoped to" },
          "user_name": { "type": "string", "title": "User Name", "description": "User name if available" },
          "mem_cube_id": { "type": "string", "title": "Mem Cube Id", "description": "MemCube ID if a single cube is targeted; otherwise None" },
          "stream_keys": { "type": "array", "items": { "type": "string" }, "title": "Stream Keys", "description": "Matched Redis stream keys for this user" },
          "users_count": { "type": "integer", "title": "Users Count", "description": "Distinct users currently present in queue streams" },
          "pending_tasks_count": { "type": "integer", "title": "Pending Tasks Count", "description": "Count of pending (delivered, not acked) tasks" },
          "remaining_tasks_count": { "type": "integer", "title": "Remaining Tasks Count", "description": "Count of enqueued tasks (xlen)" },
          "pending_tasks_detail": { "type": "array", "items": { "type": "string" }, "title": "Pending Tasks Detail", "description": "Per-stream pending counts, formatted as '{stream_key}:{count}'" },
          "remaining_tasks_detail": { "type": "array", "items": { "type": "string" }, "title": "Remaining Tasks Detail", "description": "Per-stream remaining counts, formatted as '{stream_key}:{count}'" }
        },
        "required": ["user_id", "stream_keys", "users_count", "pending_tasks_count", "remaining_tasks_count", "pending_tasks_detail", "remaining_tasks_detail"],
        "type": "object",
        "title": "TaskQueueData"
      },
      "GetUserNamesByMemoryIdsRequest": {
        "properties": {
          "memory_ids": { "type": "array", "items": { "type": "string" }, "title": "Memory Ids", "description": "Memory IDs" }
        },
        "required": ["memory_ids"],
        "type": "object",
        "title": "GetUserNamesByMemoryIdsRequest"
      },
      "GetUserNamesByMemoryIdsResponse": {
        "properties": {
          "code": { "type": "integer", "title": "Code", "description": "Response status code", "default": 200 },
          "message": { "type": "string", "title": "Message", "description": "Response message" },
          "data": { "type": "object", "additionalProperties": { "type": "string", "nullable": true }, "title": "Data", "description": "Response data" }
        },
        "required": ["message"],
        "type": "object",
        "title": "GetUserNamesByMemoryIdsResponse"
      },
      "ExistMemCubeIdRequest": {
        "properties": {
          "mem_cube_id": { "type": "string", "title": "Mem Cube Id", "description": "Mem cube ID" }
        },
        "required": ["mem_cube_id"],
        "type": "object",
        "title": "ExistMemCubeIdRequest"
      },
      "ExistMemCubeIdResponse": {
        "properties": {
          "code": { "type": "integer", "title": "Code", "description": "Response status code", "default": 200 },
          "message": { "type": "string", "title": "Message", "description": "Response message" },
          "data": { "type": "object", "additionalProperties": { "type": "boolean" }, "title": "Data", "description": "Response data" }
        },
        "required": ["message"],
        "type": "object",
        "title": "ExistMemCubeIdResponse"
      },
      "HTTPValidationError": {
        "properties": {
          "detail": {
            "items": {
              "$ref": "#/components/schemas/ValidationError"
            },
            "type": "array",
            "title": "Detail"
          }
        },
        "type": "object",
        "title": "HTTPValidationError"
      },
      "ValidationError": {
        "properties": {
          "loc": {
            "items": {
              "anyOf": [
                { "type": "string" },
                { "type": "integer" }
              ]
            },
            "type": "array",
            "title": "Location"
          },
          "msg": { "type": "string", "title": "Message" },
          "type": { "type": "string", "title": "Error Type" }
        },
        "type": "object",
        "required": ["loc", "msg", "type"],
        "title": "ValidationError"
      }
    }
  }
}
